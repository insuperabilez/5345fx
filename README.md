
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –∑–∞—Å—Ç–∞–≤–æ–∫ (–∏–Ω—Ç—Ä–æ) –≤ —Å–µ–∑–æ–Ω–∞—Ö —Å–µ—Ä–∏–∞–ª–æ–≤. –ê–ª–≥–æ—Ä–∏—Ç–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä—Ü–µ–ø—Ç–∏–≤–Ω–æ–µ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å–µ—Ä–∏–π –∏ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –Ω–∞–∏–±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω–æ–π –æ–±—â–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –∏ —è–≤–ª—è–µ—Ç—Å—è –∑–∞—Å—Ç–∞–≤–∫–æ–π.
–°–∫—Ä–∏–ø—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç train —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –ø–æ—Å–∫–æ–ª—å–∫—É —Å—á–∏—Ç–∞–µ—Ç —Ö—ç—à–∏, —Ç–∞–∫ —á—Ç–æ –∏—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≥–æ–Ω—è–ª—Å—è –∏ –ø–æ train –∏ –ø–æ test –≤—ã–±–æ—Ä–∫–∞–º –≤–º–µ—Å—Ç–µ.

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

-   **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞:** –°–∫—Ä–∏–ø—Ç —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –≤–∏–¥–µ–æ—Ñ–∞–π–ª—ã –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Å–µ—Ä–∏–∞–ª–∞ –∏ –Ω–æ–º–µ—Ä—É —Å–µ–∑–æ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.
-   **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –ø–æ–º–µ—Ö–∞–º:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–Ω–µ—á–µ—Ç–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ** (fuzzy matching) –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä—Ü–µ–ø—Ç–∏–≤–Ω—ã—Ö —Ö—ç—à–µ–π (`dhash`) –∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –•—ç–º–º–∏–Ω–≥–∞. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –∑–∞—Å—Ç–∞–≤–∫–∏, –¥–∞–∂–µ –µ—Å–ª–∏ –≤ –∫–∞–¥—Ä–∞—Ö –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∏–µ —Ä–∞–∑–ª–∏—á–∏—è (–ª–æ–≥–æ—Ç–∏–ø—ã –∫–∞–Ω–∞–ª–æ–≤, –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–∂–∞—Ç–∏—è, —Å—É–±—Ç–∏—Ç—Ä—ã).
-   **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª–∏–Ω–Ω–æ–π –∑–∞—Å—Ç–∞–≤–∫–∏:** –ê–ª–≥–æ—Ä–∏—Ç–º –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ–±—â–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –≤—ã–±–∏—Ä–∞–µ—Ç **—Å–∞–º—É—é –¥–ª–∏–Ω–Ω—É—é** –∏–∑ –Ω–∏—Ö, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –∑–∞—Å—Ç–∞–≤–∫—É, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–µ –≤ –Ω–∞—á–∞–ª–µ –≤–∏–¥–µ–æ.
-   **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞–µ–≤:**
    -   –î–ª—è —Å–µ—Ä–∏–∞–ª–æ–≤, –≥–¥–µ –≤ –≥—Ä—É–ø–ø–µ –≤—Å–µ–≥–æ **–æ–¥–Ω–∞ —Å–µ—Ä–∏—è**, –≤—ã–¥–∞–µ—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
    -   –ï—Å–ª–∏ –∞–ª–≥–æ—Ä–∏—Ç–º **–Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç** –æ–±—â—É—é –∑–∞—Å—Ç–∞–≤–∫—É –¥–ª—è –≥—Ä—É–ø–ø—ã, —Ç–∞–∫–∂–µ –≤—ã–¥–∞–µ—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
    -   –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞–π–¥–µ–Ω–Ω–æ–π –∑–∞—Å—Ç–∞–≤–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π –Ω–∞ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å—Ü–µ–Ω–∞—Ö.
-   **–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (IoU):** –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –º–µ—Ç—Ä–∏–∫—É **Intersection over Union (IoU)**, —Å—Ä–∞–≤–Ω–∏–≤–∞—è –Ω–∞–π–¥–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å "–∏–¥–µ–∞–ª—å–Ω—ã–º–∏" –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ —Ñ–∞–π–ª–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã.

## ‚öôÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

–ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ—Ö–æ–¥–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤:

1.  **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞:** –°—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è `labels.json`, –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏—è –∏ —Å–µ–∑–æ–Ω—ã. –í–∏–¥–µ–æ—Ñ–∞–π–ª—ã –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É "–æ–¥–∏–Ω —Å–µ—Ä–∏–∞–ª ‚Äî –æ–¥–∏–Ω —Å–µ–∑–æ–Ω".
2.  **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –î–ª—è –∫–∞–∂–¥–æ–π —Å–µ—Ä–∏–∏ –≤ –≥—Ä—É–ø–ø–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–∞–¥—Ä–æ–≤ (1 –∫–∞–¥—Ä –≤ —Å–µ–∫—É–Ω–¥—É) –∏–∑ –Ω–∞—á–∞–ª–∞ –≤–∏–¥–µ–æ. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–¥—Ä–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø–µ—Ä—Ü–µ–ø—Ç–∏–≤–Ω—ã–π —Ö—ç—à `dhash`.
3.  **–ü–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π:**
    *   –û–¥–Ω–∞ —Å–µ—Ä–∏—è –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ **—ç—Ç–∞–ª–æ–Ω–∞**.
    *   –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–¥—Ä–∞ —ç—Ç–∞–ª–æ–Ω–∞ —Å–∫—Ä–∏–ø—Ç –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç, –≤ —Å–∫–æ–ª—å–∫–∏—Ö **–¥—Ä—É–≥–∏—Ö —Å–µ—Ä–∏—è—Ö** –≤ —Ç–æ–π –∂–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ (—Å –Ω–µ–±–æ–ª—å—à–∏–º –¥–æ–ø—É—Å–∫–æ–º) –µ—Å—Ç—å –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–∏–π –∫–∞–¥—Ä (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –•—ç–º–º–∏–Ω–≥–∞ –º–µ–∂–¥—É —Ö—ç—à–∞–º–∏ –º–µ–Ω—å—à–µ –ø–æ—Ä–æ–≥–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è).
    *   –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Å—Ç—Ä–æ–∏—Ç—Å—è "–≥—Ä–∞—Ñ–∏–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π" –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è —ç—Ç–∞–ª–æ–Ω–Ω–æ–π —Å–µ—Ä–∏–∏.
4.  **–í—ã–±–æ—Ä –∫–∞–Ω–¥–∏–¥–∞—Ç–∞:**
    *   –ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ –∏—â—É—Ç—Å—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏, –≥–¥–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤—ã—Å–æ–∫–æ–µ (–ø—Ä–µ–≤—ã—à–∞–µ—Ç `MIN_MATCH_PERCENTAGE`).
    *   –ò–∑ –≤—Å–µ—Ö –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–∫–æ–≤, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏—Ö –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω–µ (`MIN_INTRO_DURATION`), –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è **—Å–∞–º—ã–π –¥–ª–∏–Ω–Ω—ã–π**.
5.  **–§–∏–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞:**
    *   –ï—Å–ª–∏ –¥–ª–∏–Ω–Ω—ã–π –∫–∞–Ω–¥–∏–¥–∞—Ç –Ω–∞–π–¥–µ–Ω, –µ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –∑–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ. –ï—Å–ª–∏ –Ω–µ—Ç (–∏–ª–∏ —Å–µ—Ä–∏—è –æ–¥–Ω–∞) ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
    *   –ü–æ–ª—É—á–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ `labels.json` –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ **IoU**.
6.  **–û—Ç—á–µ—Ç:** –í—ã–≤–æ–¥–∏—Ç—Å—è –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –∏ —Å—Ä–µ–¥–Ω–µ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é –ø–æ –≤—Å–µ–º—É –Ω–∞–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö.

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

-   Python 3.8+
-   –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:
    ```
    .
    ‚îú‚îÄ‚îÄ data/
    ‚îÇ   ‚îú‚îÄ‚îÄ -220020068_456255414/
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ -220020068_456255414.mp4
    ‚îÇ   ‚îú‚îÄ‚îÄ -220020068_456249693/
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ -220020068_456249693.mp4
    ‚îÇ   ‚îî‚îÄ‚îÄ ...
    ‚îú‚îÄ‚îÄ labels.json
    ‚îî‚îÄ‚îÄ main.ipynb
    ```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install opencv-python Pillow ImageHash numpy tqdm
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç

–û–ë–©–ï–ï –°–†–ï–î–ù–ï–ï –ö–ê–ß–ï–°–¢–í–û (IoU) –ü–û –í–°–ï–ú –°–ï–†–ò–Ø–ú: 20.80% (–∏ –Ω–∞ train –∏ –Ω–∞ test –≤—ã–±–æ—Ä–∫–∞—Ö –≤–º–µ—Å—Ç–µ)

### –í—ã–≤–æ–¥—ã
–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–º—è –ª—É—á—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ —Ö—ç—à–∏, –∞ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–¥—Ä–æ–≤ (1 - –µ—Å—Ç—å –∑–∞—Å—Ç–∞–≤–∫–∞, 0 - –Ω–µ—Ç –∑–∞—Å—Ç–∞–≤–∫–∏).
–û–¥–Ω–∞–∫–æ —ç—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –∏ –±–æ–ª–µ–µ —á–∏—Å—Ç–æ–π —Ä–∞–∑–º–µ—Ç–∫–∏, —Ç.–∫.  –≤ –¥–∞–Ω–Ω–æ–π —Ä–∞–∑–º–µ—Ç–∫–µ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π, –≥–¥–µ-—Ç–æ "–º–∏—Ä —Å–µ—Ä–∏–∞–ª–æ–≤" —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞—Å—Ç–∞–≤–∫–æ–π, –≥–¥–µ-—Ç–æ –Ω–µ—Ç, –≤ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö –∑–∞—Å—Ç–∞–≤–∫–∞ –Ω–µ—Ç—Ñ–ª–∏–∫—Å–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è, –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç, –∞ –µ—Å—Ç—å –∏ –ø—Ä–æ—Å—Ç–æ –æ—à–∏–±–æ—á–Ω—ã–µ —Ä–∞–∑–º–µ—Ç–∫–∏.

